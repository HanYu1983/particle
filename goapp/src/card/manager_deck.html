<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8"/>
	<title>余氏組牌機</title>
	<!--page information for search engine-->
	<meta name="title" content="余氏組牌機" />
	<meta name="keyword" content="余氏組牌機,卡牌風雲,三國志大戰,集換式卡牌,線上卡牌,虛擬桌面,組牌機" />
	<meta name="description" content="余氏組牌機" />
	<link rel="image_src" href=""/>
	
	<!--share information for fb-->
	<meta property="og:description" content="余氏組牌機" />
	<meta property="og:title" content="余氏組牌機" />
	<meta property="og:url" content="http://particle-979.appspot.com/card/manager_sango.html#"/>
	<meta name="description" content="" />
	
	<link rel="stylesheet" type="text/css" href="../common/js/lib/jquery-easyui-1.4.3/themes/black/easyui.css">
	<link rel="stylesheet" type="text/css" href="../common/js/lib/jquery-easyui-1.4.3/themes/icon.css">
	<link rel="stylesheet" type="text/css" href="../common/css/normalize.css">
		
	<script type="text/javascript" src="../common/js/lib/leo.utils.js"></script>
	<script type="text/javascript" src="../common/js/lib/underscore/underscore-min.js"></script>
	<script type="text/javascript" src="../common/js/lib/jquery-easyui-1.4.3/jquery.min.js"></script>
	<script type="text/javascript" src="../common/js/lib/jquery-easyui-1.4.3/jquery.easyui.min.js"></script>
	<script type="text/javascript" src="../common/js/lib/jquery/jquery.tmpl.min.js"></script>
	<script type="text/javascript" src="../common/js/lib/google/ga.js"></script>
	<script src="../common/js/lib/csv.js"></script>
	<script src="../common/js/lib/purl.js"></script>	
	<script src="../common/js/sangoWar.js"></script>	
	<script src="../common/js/yugioh.js"></script>	
	<script src="../common/js/magic.js"></script>	
	<script src="../common/js/cardsearch.js"></script>	
	<script src='js/api.js'></script>
</head>
<style>
body{
	position:absolute;
	top:0;
	left:0;
	width:100%;
	height:100%;
}
.group{
	position:relative;
	width:100%;
}
.hori{
	display:inline-block;
}

.card_item_root{
	position:relative;
	width:100%;
	height:60px;
	border:1px black solid;
}

.big_card_root{
	position:relative;
	display:inline-block;
	width:260px;
	height:390px;;
	cursor:pointer;
	border:1px black solid;
}

.big_card_root_focus{
	border:1px red solid;
}
</style>

<script id="tmpl_bigCard" type="jquery-x-tmpl">
	<div cid=${id} class="big_card_root">
		<img style="position:absolute; left:0; top:0; width:100%; height:100%;" src="../common/images/card/cardback_0.png"/>
		<img src=${url} style="position:relative; top:0; left:0; width:100%; height:100%;" />
		<img style="position:absolute; left:0; top:0; width:100%; height:100%;" src="images/sampleTxt.png"/>
		<div style="position:absolute; left:0; top:0;  width:100%; height:100%; background-color:black; opacity:.5;"></div>
		<div style="position:absolute; top:0; left:0; padding-left:50px; padding-right:10px; padding-top:10px; ">
			<div>${id}</div>
			<div game="sangoWar">${cname}</div>
			<div game="sangoWar">${ability}</div>
			<div game="sangoWar">${content}</div>
			<br/>
			<div game="sangoWar">${counter}</div>
			
			<div game="yugioh">${name}</div>
			<div game="yugioh">level ${level}</div>
			<div game="yugioh">${type}</div>
			<div game="yugioh">${race}</div>
			<div game="yugioh">${text}</div>
			
			<div game="magic">${type}</div>
			<div game="magic">${text}</div>
		</div>
	</div>
</script>
<script id="tmpl_cardItem" type="jquery-x-tmpl">
	<div id=${itemId} cid=${id} class="card_item_root">
		<div class="hori" style="position:relative; top:0; left:0; height:100%; vertical-align:top;">
			<a id="btn_remove" href="#" class="easyui-linkbutton" style="width:30px; height:100%;" data-options="iconCls:'icon-remove'"></a>
		</div>
		<div class="hori" style="position:relative; top:0; left:0; height:100%; vertical-align:top;">
			<a id="btn_copy" href="#" class="easyui-linkbutton" style="width:30px; height:100%;" data-options="iconCls:'icon-add'"></a>
		</div>
		<div class="hori" style="position:relative; height:100%;">
			<img style="position:relative; left:0; top:0; height:100%;" src="../common/images/card/cardback_0.png"/>
			<img style="position:absolute; left:0; top:0; height:100%;" src=${url}  style="height:100%;" />
		</div>
		<div class="hori" style=" vertical-align:top;">
			<div>${id}</div>
			<div game="sangoWar">${cname}</div>
			<div game="sangoWar">${ctype}</div>
			
			<div game="yugioh">${name}</div>
			<div game="yugioh">level ${level}</div>
			<div game="yugioh">${type}</div>

			<div game="magic">${type}</div>
		</div>
	</div>
</script>
<!--
id: card.find('name').html(),
name: card.find('name').html(),
color: "UB",
manacost: [W, B, R, U, G, 5],
cmc: card.find('cmc').html(),
type: card.find('type').html(),
tablerow: card.find('tablerow').html(),
text: card.find('text').html(),
atk: atk,
def: def
-->
<script id="tmpl_magicForm" type="jquery-x-tmpl">
	<table border="1">
		<tr>
			<td>白</td>
			<td>
				<select name="white_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以上
				<select name="white_2">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以下
			</td>
			<td>綠</td>
			<td>
				<select name="green_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以上
				<select name="green_2">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>藍</td>
			<td>
				<select name="blue_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以上
				<select name="blue_2">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以下
			</td>
			<td>紅</td>
			<td>
				<select name="red_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以上
				<select name="red_2">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>黑</td>
			<td>
				<select name="black_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以上
				<select name="black_2">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以下
			</td>
			<td>總cost</td>
			<td>
				<select name="all_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以上
				<select name="all_2">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>系列</td>
			<td colspan=3>
				<select name="set">
					<option ></option>
					<option value="4E">4E</option>
					<option value="5E">5E</option>
					<option value="6E">6E</option>
					<option value="7E">7E</option>
					<option value="8E">8E</option>
					<option value="9E">9E</option>
					<option value="10E">10E</option>
					
					<option value="ALA">ALA</option>
					<option value="ALP">ALP</option>
					<option value="AVR">AVR</option>
					<option value="ARB">ARB</option>
					<option value="AP">AP</option>
					<option value="AL">AL</option>
					<option value="AN">AN</option>
					
					<option value="BNG">BNG</option>
					<option value="BFZ">BFZ</option>
					<option value="BOK">BOK</option>
					
					<option value="C13">C13</option>
					<option value="C14">C14</option>
					<option value="C15">C15</option>
					<option value="CNS">CNS</option>
					<option value="CMD">CMD</option>
					<option value="CS">CS</option>
					<option value="CHK">CHK</option>
					<option value="CHR">CHR</option>
					
					<option value="DTK">DTK</option>
					<option value="DGM">DGM</option>
					<option value="DKA">DKA</option>
					<option value="DI">DI</option>
					<option value="DS">DS</option>
					<option value="DK">DK</option>
					
					<option value="KTK">KTK</option>
					
					
					<option value="JU">JU</option>
					<option value="JOU">JOU</option>
					
					<option value="MR">MR</option>
					<option value="MOR">MOR</option>
					<option value="MBS">MBS</option>
					<option value="MI">MI</option>
					<option value="MM">MM</option>
					<option value="MM2">MM2</option>
					<option value="MMA">MMA</option>
					<option value="M10">M10</option>
					<option value="M11">M11</option>
					<option value="M12">M12</option>
					<option value="M13">M13</option>
					<option value="M14">M14</option>
					<option value="M15">M15</option>
					
					<option value="EXP">EXP</option>
					<option value="EVE">EVE</option>
					<option value="EX">EX</option>
					
					<option value="FRF">FRF</option>
					<option value="FE">FE</option>
					<option value="FUT">FUT</option>
					
					<option value="ORI">ORI</option>
					<option value="ON">ON</option>
					<option value="OD">OD</option>
					
					<option value="GTC">GTC</option>
					<option value="GP">GP</option>
					
					<option value="THS">THS</option>
					<option value="TS">TS</option>
					<option value="TO">TO</option>
					<option value="TP">TP</option>
					
					
					<option value="PC">PC</option>
					<option value="PC2">PC2</option>
					<option value="PTK">PTK</option>
					<option value="PO">PO</option>
					<option value="PO2">PO2</option>
					<option value="PR">PR</option>
					
					<option value="NPH">NPH</option>
					
					<option value="ISD">ISD</option>
					<option value="IN">IN</option>
					
					
					<option value="SHM">SHM</option>
					<option value="SOM">SOM</option>
					<option value="SOK">SOK</option>
					<option value="SC">SC</option>
					<option value="SH">SH</option>
					<option value="S99">S99</option>
					
					<option value="RTR">RTR</option>
					<option value="ROE">ROE</option>
					<option value="RAV">RAV</option>
					
					<option value="WWK">WWK</option>
					
					
					<option value="LE">LE</option>
					
				
					
					
					<option value="UN">UN</option>
					<option value="UD">UD</option>
					<option value="UL">UL</option>
					<option value="US">US</option>
					
					<option value="VI">VI</option>
					<option value="LG">LG</option>
					
					
					
					
					
					<!--
					<option value="ZDK">ZDK</option>
					<option value="CFX">CFX</option>
					<option value="LW">LW</option>
					<option value="CSTD">CSTD</option>
					<option value="FD">FD</option>
					<option value="PS">PS</option>
					<option value="NE">NE</option>
					<option value="P3K">P3K</option>
					<option value="WL">WL</option>
					<option value="HL">HL</option>
					<option value="IA">IA</option>
					<option value="RV">RV</option>
					<option value="AQ">AQ</option>
					<option value="BE">BE</option>
					-->
				</select>
			</td>
		</tr>
		<tr>
			<td>卡片類型</td>
			<td colspan=3>
				<select name="ctype">
					<option></option>
					<option>Basic</option>
					<option>Legendary</option>
				</select>
				<select name="ctype2">
					<option></option>
					<option>Land</option>
					<option>Creature</option>
					<option>Instant</option>
					<option>Sorcery</option>
					<option>Enchantment</option>
					<option>Artifact</option>
					<option>Artifact Creature</option>
				</select>
				<select name="ctype3">
					<option></option>
					<option>Advisor</option><option>Ally</option><option>Angel</option><option>Antelope</option><option>Ape</option><option>Archer</option><option>Archon</option><option>Artificer</option><option>Assassin</option><option>Assembly-Worker</option><option>Atog</option><option>Aurochs</option><option>Avatar</option><option>Badger</option><option>Barbarian</option><option>Basilisk</option><option>Bat</option><option>Bear</option><option>Beast</option><option>Beeble</option><option>Berserker</option><option>Bird</option><option>Blinkmoth</option><option>Boar</option><option>Bringer</option><option>Brushwagg</option><option>Camarid</option><option>Camel</option><option>Caribou</option><option>Carrier</option><option>Cat</option><option>Centaur</option><option>Cephalid</option><option>Chimera</option><option>Citizen</option><option>Cleric</option><option>Cockatrice</option><option>Construct</option><option>Coward</option><option>Crab</option><option>Crocodile</option><option>Cyclops</option><option>Dauthi</option><option>Demon</option><option>Deserter</option><option>Devil</option><option>Djinn</option><option>Dragon</option><option>Drake</option><option>Dreadnought</option><option>Drone</option><option>Druid</option><option>Dryad</option><option>Dwarf</option><option>Efreet</option><option>Elder</option><option>Eldrazi</option><option>Elemental</option><option>Elephant</option><option>Elf</option><option>Elk</option><option>Eye</option><option>Faerie</option><option>Ferret</option><option>Fish</option><option>Flagbearer</option><option>Fox</option><option>Frog</option><option>Fungus</option><option>Gargoyle</option><option>Germ</option><option>Giant</option><option>Gnome</option><option>Goat</option><option>Goblin</option><option>God</option><option>Golem</option><option>Gorgon</option><option>Graveborn</option><option>Gremlin</option><option>Griffin</option><option>Hag</option><option>Harpy</option><option>Hellion</option><option>Hippo</option><option>Hippogriff</option><option>Homarid</option><option>Homunculus</option><option>Horror</option><option>Horse</option><option>Hound</option><option>Human</option><option>Hydra</option><option>Hyena</option><option>Illusion</option><option>Imp</option><option>Incarnation</option><option>Insect</option><option>Jellyfish</option><option>Juggernaut</option><option>Kavu</option><option>Kirin</option><option>Kithkin</option><option>Knight</option><option>Kobold</option><option>Kor</option><option>Kraken</option><option>Lamia</option><option>Lammasu</option><option>Leech</option><option>Leviathan</option><option>Lhurgoyf</option><option>Licid</option><option>Lizard</option><option>Manticore</option><option>Masticore</option><option>Mercenary</option><option>Merfolk</option><option>Metathran</option><option>Minion</option><option>Minotaur</option><option>Monger</option><option>Mongoose</option><option>Monk</option><option>Moonfolk</option><option>Mutant</option><option>Myr</option><option>Mystic</option><option>Naga</option><option>Nautilus</option><option>Nephilim</option><option>Nightmare</option><option>Nightstalker</option><option>Ninja</option><option>Noggle</option><option>Nomad</option><option>Nymph</option><option>Octopus</option><option>Ogre</option><option>Ooze</option><option>Orb</option><option>Orc</option><option>Orgg</option><option>Ouphe</option><option>Ox</option><option>Oyster</option><option>Pegasus</option><option>Pentavite</option><option>Pest</option><option>Phelddagrif</option><option>Phoenix</option><option>Pincher</option><option>Pirate</option><option>Plant</option><option>Praetor</option><option>Prism</option><option>Processor</option><option>Rabbit</option><option>Rat</option><option>Rebel</option><option>Reflection</option><option>Rhino</option><option>Rigger</option><option>Rogue</option><option>Sable</option><option>Salamander</option><option>Samurai</option><option>Sand</option><option>Saproling</option><option>Satyr</option><option>Scarecrow</option><option>Scion</option><option>Scorpion</option><option>Scout</option><option>Serf</option><option>Serpent</option><option>Shade</option><option>Shaman</option><option>Shapeshifter</option><option>Sheep</option><option>Siren</option><option>Skeleton</option><option>Slith</option><option>Sliver</option><option>Slug</option><option>Snake</option><option>Soldier</option><option>Soltari</option><option>Spawn</option><option>Specter</option><option>Spellshaper</option><option>Sphinx</option><option>Spider</option><option>Spike</option><option>Spirit</option><option>Splinter</option><option>Sponge</option><option>Squid</option><option>Squirrel</option><option>Starfish</option><option>Surrakar</option><option>Survivor</option><option>Tetravite</option><option>Thalakos</option><option>Thopter</option><option>Thrull</option><option>Treefolk</option><option>Triskelavite</option><option>Troll</option><option>Turtle</option><option>Unicorn</option><option>Vampire</option><option>Vedalken</option><option>Viashino</option><option>Volver</option><option>Wall</option><option>Warrior</option><option>Weird</option><option>Werewolf</option><option>Whale</option><option>Wizard</option><option>Wolf</option><option>Wolverine</option><option>Wombat</option><option>Worm</option><option>Wraith</option><option>Wurm</option><option>Yeti</option><option>Zombie</option><option>Zubera</option>
				</select>
			</td>
		</tr>
		<tr>
			<td>攻擊力&防守力</td>
			<td colspan=3>
				攻擊力
				<select name="atk_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以上
				<select name="atk_2">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以下 || 防守力
				<select name="def_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以上
				<select name="def_2">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
		  <td >
			特殊規則<br>
		  </td>
		  <td colspan="3">
			<input type="checkbox" name="Deathtouch">Deathtouch
			<input type="checkbox" name="Defender">Defender
			<input type="checkbox" name="First strike">First strike
			<input type="checkbox" name="Double strike">Double strike
			<input type="checkbox" name="Flash">Flash
			<input type="checkbox" name="Flying">Flying
			<input type="checkbox" name="Haste">Haste
			<input type="checkbox" name="Hexproof">Hexproof
			<input type="checkbox" name="Protection from white">Protection from white
			<input type="checkbox" name="Protection from blue">Protection from blue
			<input type="checkbox" name="Protection from black">Protection from black
			<input type="checkbox" name="Protection from red">Protection from red
			<input type="checkbox" name="Protection from green">Protection from green
			<input type="checkbox" name="Reach">Reach
			<input type="checkbox" name="Trample">Trample
			<input type="checkbox" name="Vigilance">Vigilance
		  </td>
		</tr>
		<tr>
		  <td >
			卡片名稱檢索<br>
		  </td>
		  <td colspan="3">
			<input type="text" name="card_name" size=32>
			<br>
		  </td>
		</tr>
		<tr>
		  <td >
			卡片規則檢索<br>
		  </td>
		  <td colspan="3">
			<input type="text" name="rule" size=32>
			<br>
		  </td>
		</tr>
	</table>
</script>
			<!--
			alias: coldata[11],
			setcode: coldata[12]
			-->
<script id="tmpl_yugiohForm" type="jquery-x-tmpl">
	<table border=1>	
		<tr>
			<td>星級</td>
			<td>
				<select name="level_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
					<option>11</option>
					<option>12</option>
				</select>
				以上
				<select name="level_2">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
					<option>11</option>
					<option>12</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>屬性</td>
			<td>
				<select name="attr">
					<option></option>
					<option>Earth</option>
					<option>Water</option>
					<option>Fire</option>
					<option>Wind</option>
					<option>Light</option>
					<option>Dark</option>
					<option>Divine</option>
				</select>
			</td>
		</tr>
		<tr>
			<td>種族</td>
			<td>
				<select name="race">
					<option></option>
					<option>Warrior</option>
					<option>Spellcaster</option>
					<option>Fairy</option>
					<option>Fiend</option>
					<option>Zombie</option>
					<option>Machine</option>
					<option>Aqua</option>
					<option>Pyro</option>
					<option>Rock</option>
					<option>Winged Beast</option>
					<option>Plant</option>
					<option>Insect</option>
					<option>Thunder</option>
					<option>Dragon</option>
					<option>Beast</option>
					<option>Beast-Warrior</option>
					<option>Dinosaur</option>
					<option>Fish</option>
					<option>Sea Serpent</option>
					<option>Reptile</option>
					<option>Psychic</option>
					<option>Divine-Beast</option>
					<option>Creator God</option>
					<option>Wyrm</option>
				</select>
			</td>
		</tr>
		
		<tr>
			<td>卡片類型</td>
			<td>
				<select name="ctype">
					<option></option>
					<option>Monster</option>
					<option>Spell</option>
					<option>Trap</option>
				</select>
				<select name="ctype2">
					<option></option>
					<option>Normal</option>
					<option>Effect</option>
					<option>Fusion</option>
					<option>Ritual</option>
					<option>Trap Monsters</option>
					<option>Spirit</option>
					<option>Union</option>
					<option>Gemini</option>
					<option>Tuner</option>
					<option>Synchro</option>
					<option>Token</option>
					<option>Quick-Play</option>
					<option>Continuous</option>
					<option>Equip</option>
					<option>Field</option>
					<option>Counter</option>
					<option>Flip</option>
					<option>Toon</option>
					<option>Xyz</option>
					<option>Pendulum</option>
				</select>
			</td>
		</tr>
		<tr>
			<td>攻擊力</td>
			<td>
				<select name="atk_1">
					<option></option>
					<option>500</option>
					<option>1000</option>
					<option>1500</option>
					<option>2000</option>
					<option>2500</option>
					<option>3000</option>
					<option>3500</option>
					<option>4000</option>
					<option>4500</option>
					<option>5000</option>
				</select>
				以上
				<select name="atk_2">
					<option></option>
					<option>500</option>
					<option>1000</option>
					<option>1500</option>
					<option>2000</option>
					<option>2500</option>
					<option>3000</option>
					<option>3500</option>
					<option>4000</option>
					<option>4500</option>
					<option>5000</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>防守力</td>
			<td>
				<select name="def_1">
					<option></option>
					<option>500</option>
					<option>1000</option>
					<option>1500</option>
					<option>2000</option>
					<option>2500</option>
					<option>3000</option>
					<option>3500</option>
					<option>4000</option>
					<option>4500</option>
					<option>5000</option>
				</select>
				以上
				<select name="def_2">
					<option></option>
					<option>500</option>
					<option>1000</option>
					<option>1500</option>
					<option>2000</option>
					<option>2500</option>
					<option>3000</option>
					<option>3500</option>
					<option>4000</option>
					<option>4500</option>
					<option>5000</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>左擺蕩</td>
			<td>
				<select name="lscale_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以上
				<select name="lscale_2">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>右擺蕩</td>
			<td>
				<select name="rscale_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以上
				<select name="rscale_2">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
		  <td >
			卡片名稱檢索<br>
		  </td>
		  <td colspan="3">
			<input type="text" name="card_name" size=32>
			<br>
		  </td>
		</tr>
		<tr>
		  <td >
			卡片規則檢索<br>
		  </td>
		  <td colspan="3">
			<input type="text" name="rule" size=32>
			<br>
		  </td>
		</tr>
		 <tr>
		  <td >
			id檢索<br>
		  </td>
		  <td colspan="3">
			  <input id="txt_id" type="text" name="id" size=16>
		  </td>
		</tr>
	</table>
</script>
<script id="tmpl_sangoWarForm" type="jquery-x-tmpl">
	<table cellpadding=2 cellspacing=0 border=1>	
		<tr>
		  <td >
			勢力<br>
		  </td>
		  <td colspan="3">
			  <select name="ntype">
				  <option></option>
				  <option>蜀</option>
				  <option>魏</option>
				  <option>呉</option>
				  <option>漢</option>
				  <option>群</option>
				  <option>他</option>
			  </select>
		  </td>
		</tr>
		<tr>
		  <td >
			卡片種類<br>
		  </td>
		  <td colspan="3">
			  <select name="ctype">
				  <option></option>
				  <option>武将</option>
				  <option>武将/兵隊</option>
				  <option>計略</option>
				  <option>キャンペーン</option>
			  </select>
			</td>
		</tr>
		<tr>
		  <td  width="25%">
			指定cost<br>
		  </td>
		  <td width="25%">
			<select name="cost_1">
			  <option></option>
			  <option>1</option>
			  <option>2</option>
			  <option>3</option>
			  <option>4</option>
				<option>5</option>
			</select>
			以上
			<select name="cost_2">
			  <option></option>
			  <option>1</option>
			  <option>2</option>
			  <option>3</option>
			  <option>4</option>
				<option>5</option>
			</select>
			以下
			<br>
		  </td>
		  <td  width="25%">
			武力<br>
		  </td>
		  <td width="25%">
			<select name="power_1">
			  <option value=""></option>
			  <option value="500">500</option>
			  <option value="1000">1000</option>
			  <option value="1500">1500</option>
			  <option value="2000">2000</option>
			  <option value="2500">2500</option>
			  <option value="3000">3000</option>
			  <option value="3500">3500</option>
			  <option value="4000">4000</option>
			  <option value="4500">4500</option>
			</select>
			以上
			<select name="power_2">
			  <option value=""></option>
			  <option value="500">500</option>
			  <option value="1000">1000</option>
			  <option value="1500">1500</option>
			  <option value="2000">2000</option>
			  <option value="2500">2500</option>
			  <option value="3000">3000</option>
			  <option value="3500">3500</option>
			  <option value="4000">4000</option>
			  <option value="4500">4500</option>
			</select>
			以下   
			<br>
		  </td>
		</tr>
		<tr>
		  <td>
			合計cost<br>
		  </td>
		  <td>
			<select name="costAll_1">
			  <option value=""></option>
			  <option>1</option>
			  <option>2</option>
			  <option>3</option>
			  <option>4</option>
				<option>5</option>
				<option>6</option>
				<option>7</option>
				<option>8</option>
				<option>9</option>
				<option>10</option>
			</select>
			以上
			<select name="costAll_2">
			  <option value=""></option>
			  <option>1</option>
			  <option>2</option>
			  <option>3</option>
			  <option>4</option>
				<option>5</option>
				<option>6</option>
				<option>7</option>
				<option>8</option>
				<option>9</option>
				<option>10</option>
			</select>
			以下
			<br>
		  </td>
		  <td >
			攻城<br>
		  </td>
		  <td>
			<select name="acity">
			  <option value=""></option>
			  <option>1</option>
			  <option>2</option>
			</select>
		  </td>
		</tr>
		<tr>
		  <td >
			兵種<br>
		  </td>
		  <td colspan="3">
			<select name="atype">
				<option></option>
				<option>槍兵</option>
				<option>騎兵</option>
				<option>弓兵</option>
				<option>歩兵</option>
				<option>象兵</option>
			</select>
		  </td>
		</tr>
		<tr>
		  <td >
			特徵<br>
		  </td>
		  <td colspan="3">
			  <select name="symbol">
				  <option></option>
				  <option>計略/戦闘</option>
				  <option>計略/メイン</option>
				  <option>女性</option>
				  <option>南蛮・女性</option>
				  <option>魏五将</option>
				  <option>五虎将</option>
				  <option>軍師</option>
				  <option>黄巾</option>
				  <option>兵隊</option>
				  <option>旗本四天王</option>
				  <option>君主</option>
				  <option>賢女</option>
				  <option>西園八校尉</option>
				  <option>十常侍</option>
			  </select>
		  </td>
		</tr>
		<tr>
		  <td >
			特殊規則<br>
		  </td>
		  <td colspan="3">
			<input type="checkbox" name="戦象">戦象
			<input type="checkbox" name="走射">走射
			<input type="checkbox" name="決起">決起
			<input type="checkbox" name="奇襲">奇襲
			<input type="checkbox" name="長槍">長槍
			<input type="checkbox" name="外交">外交
			<input type="checkbox" name="伏兵">伏兵
			<input type="checkbox" name="乱舞">乱舞
			<input type="checkbox" name="憂国">憂国
			<input type="checkbox" name="支援">支援
			<input type="checkbox" name="募兵">募兵
			<input type="checkbox" name="貫通">貫通
			<input type="checkbox" name="援軍">援軍
			<input type="checkbox" name="回避">回避
			<input type="checkbox" name="防柵">防柵
			<input type="checkbox" name="補佐">補佐
			<input type="checkbox" name="連弩">連弩
			<input type="checkbox" name="舞闘">舞闘
			<input type="checkbox" name="強進">強進
			<input type="checkbox" name="先駆">先駆
			<input type="checkbox" name="覚醒">覚醒
			<input type="checkbox" name="国防">国防
			<input type="checkbox" name="突撃">突撃
			<input type="checkbox" name="威圧">威圧
			<input type="checkbox" name="同盟">同盟
		  </td>
		</tr>
		<tr>
		  <td >
			卡片名稱檢索<br>
		  </td>
		  <td colspan="3">
			<input type="text" name="card_name" size=32>
			<br>
		  </td>
		</tr>
		<tr>
		  <td >
			卡片規則檢索<br>
		  </td>
		  <td colspan="3">
			<input type="text" name="rule" size=32>
			<br>
		  </td>
		</tr>
		 <tr>
		  <td >
			id檢索<br>
		  </td>
		  <td colspan="3">
			  <input id="txt_id" type="text" name="id" size=16>
		  </td>
		</tr>
	  </table>
</script>
<body>
	<div id="cc" class="easyui-layout" style="width:100%;height:100%;">
		<div data-options="region:'north',title:'條件',split:true" style="height:330px;">
			<div class="group" style="text-align:center; margin-top:10px;">
				<div class="group">
					<form id="form_container" name="form_value" class="hori">
						<!-- by script -->
					</form>
				</div>
				<div class="group">
					<div class="hori">
						<a id="btn" href="#" class="easyui-linkbutton" style="width:200px; height:40px;" onclick="app.view.onResetClick()" data-options="iconCls:'icon-edit'">重設</a>
					</div>
					<div class="hori">
						<a id="btn_search" href="#" class="easyui-linkbutton" style="width:200px; height:40px;" onclick="app.view.onSearchClick()" data-options="iconCls:'icon-search',disabled:true">搜尋</a>
					</div>
				</div>
				<div style="position:absolute; right:5px; top:0px; ">
					<a id="btn_about" href="#" title="其它遊戲的組牌機，目前有三國志大戰、遊戲王、魔法風雲會" class="easyui-linkbutton easyui-tooltip" onclick="$('#dia_others').panel( 'open' )" data-options="iconCls:'icon-redo'">其它遊戲</a>
					<a id="btn_about" href="#" title="關於上善若水" class="easyui-linkbutton easyui-tooltip" onclick="$('#dia_about').panel( 'open' )" data-options="iconCls:'icon-help'"></a>
				</div>
			</div>
		</div>
		<div data-options="region:'center',title:'結果'">
			<div id="pag_bigCard" class="easyui-pagination" data-options="pageSize:20,layout:['first','links','last']"></div>
			<div id="mc_bigCardContainer" >
				
			</div>
		</div>
		<div data-options="region:'east',title:'組牌'" style="width:350px; overflow-x:hidden;">
			<div class="group" style="text-align:center; margin-top:10px;">
				<div class="hori">
					<span id="txt_count" style="color:yellow">0</span>張
				</div>
				<div class="hori">
					<div class="hori">
						<a id="btn" href="#" class="easyui-linkbutton" style="width:100px; height:40px;" onclick="app.view.onClearClick()" data-options="iconCls:'icon-remove'">清空</a>
					</div>
					<div class="hori">
						<a id="btn_output" href="#" class="easyui-linkbutton" style="width:100px; height:40px;" onclick="app.view.onSaveClick()" data-options="iconCls:'icon-save',disabled:true">匯入/匯出</a>
					</div>
				</div>
			</div>
			<div id="mc_cardContainer" class="group" style="margin-top:10px;">
				
			</div>
		</div>
	</div>
	<div id="win_output" class="easyui-window" title="匯入/匯出" data-options="minimizable:false,maximizable:false,collapsible:false,closed:true,modal:true" style="width:500px;height:300px" >
		<div class="group" style="text-align:center;">
			<input class="easyui-textbox" data-options="multiline:true" style="width:100%; height:200px">
			<div class="hori" style="margin-top:10px;">
				<a id="btn" href="#" class="easyui-linkbutton" style="width:80px; height:40px;" onclick="app.view.onLoadClick()" data-options="iconCls:'icon-save'">匯入</a>
				<a id="btn" href="#" class="easyui-linkbutton" style="width:120px; height:40px;" onclick="app.view.onSetDeckClick()" data-options="iconCls:'icon-back'">去輸入牌組</a>
				<a id="btn" href="#" class="easyui-linkbutton" style="width:140px; height:40px;" onclick="app.view.onGotoGameClick()" data-options="iconCls:'icon-redo'">線上打牌去</a>
			</div>
		</div>
	</div>
	<div id="dia_about" class="easyui-dialog" title="卡牌風雲" data-options="iconCls:'icon-help',closed:true" style="padding:10px">
		<div class="group" style="position:relative; width:100%; text-align:center;">
			<div class="hori" >
				上善若水APP
				<br/>
				<img src="../common/images/logo.jpg" width="100" height="100">
				<br/>
				<a style="color:yellow" href="//www.facebook.com/pages/上善若水/1653920964852269" target="_blank">上善若水粉絲頁</a>
				<br/><br/>
				<a style="color:yellow" href="//particle-979.appspot.com/manager/index.html#" target="_blank">上善若水官網&牌組管理器</a>
				<br/><br/>
			</div>
		</div>
	</div>
	<div id="dia_others" class="easyui-dialog" title="組牌機列表" data-options="closed:true" style="padding:10px">
		<div class="group" style="position:relative; width:100%; text-align:center;">
			<div class="hori" >
				<a id="btn_about" href="#" class="easyui-linkbutton" onclick="window.open('manager_deck.html?game=sangoWar')" data-options="iconCls:'icon-redo'">三國志大戰</a>
				<a id="btn_about" href="#" class="easyui-linkbutton" onclick="window.open('manager_deck.html?game=yugioh')" data-options="iconCls:'icon-redo'">遊戲王</a>
				<a id="btn_about" href="#" class="easyui-linkbutton" onclick="window.open('manager_deck.html?game=magic')" data-options="iconCls:'icon-redo'">魔法風雲會</a>
			</div>
		</div>
	</div>
	<script src="js/manager_deck_gameController.js"></script>
	<script>
	googleTracking.init( 'UA-55273266-3' );
	
	var game = (function( hashobj ){
		if( hashobj.game == undefined ) return 'sangoWar';
		switch( hashobj.game ){
			case 'sangoWar':
			case 'yugioh':
			case 'magic':
				return hashobj.game;
			default:
				return 'sangoWar';
		}
	})( leo.utils.getHash() );
	
	var cardlist;
	var itemId = 0;
	var form_container = $('#form_container' );
	var tmpl_form = $('#tmpl_' + game + 'Form' );
	
	form_container.append( tmpl_form.tmpl() );
	gameController.loadCardData( game, onLoadGameCallback );
	
	$.messager.progress({text:'讀取資料中…'}); 
	
	function onLoadGameCallback( err, _cardlist ){
		cardlist = _cardlist;
		$("#btn_search").linkbutton( 'enable' );
		$("#btn_output").linkbutton( 'enable' );
		
		$.messager.progress( 'close' ); 
	}
	
	function getId(){
		return itemId++;
	}
	
	function handleResponse( cb ) {
		return function ( err, ret ) {
			if ( err != null ) {
				alert( '錯誤:' + err );
			}else {
				cb( ret );
			}
		}
	}
	
	var app = app || {};
	app.view = app.view || {};
	
	(function( module ){
		var mc_bigCardContainer = $('#mc_bigCardContainer' );
		var win_output = $('#win_output' );
		var mc_cardContainer = $('#mc_cardContainer' );
		var txt_count = $('#txt_count' );
		var pag_bigCard = $('#pag_bigCard' );
		var currentPage = 0;
		var ary_cards;
		var ary_deck = [];
		
		function createBigCard(){
			if( ary_cards == undefined ) return; 
			mc_bigCardContainer.empty();
			
			var sid = currentPage * 20;
			var eid = currentPage * 20 + 20;
			
			if( eid > ary_cards.length ){
				eid = ary_cards.length;
			}
			
			var showCards = ary_cards.slice( sid, eid );
			_.each( showCards, function( card ){
				card.url = gameController.getCardUrl( game, card );
				if( card.url == undefined ) {
					card.url = 'images/cardback.png';
				}
				
				var div = $("#tmpl_bigCard").tmpl( card );
				div.find( 'div[game]' ).hide();
				div.find( 'div[game=' + game + ']' ).show();
				div.attr( 'data', JSON.stringify( card ));
				div.click( function(){
					var thisDom = $(this);
					outFocusAll();
					thisDom.addClass( 'big_card_root_focus' );
					pushToDeck( JSON.parse( thisDom.attr( 'data' ) ));
				});
				mc_bigCardContainer.append( div );
			});
			
			function outFocusAll(){
				mc_bigCardContainer.find( 'div' ).removeClass( 'big_card_root_focus' );
			}
		}
		
		function setDeck(){
			
			var oldtop = mc_cardContainer.parent().scrollTop();
			mc_cardContainer.empty();
			
			ary_deck.sort( function( aobj, bobj ){
				switch( game ){
					case 'sangoWar':
						return aobj.cname.localeCompare( bobj.cname );
					default:
						return aobj.id.localeCompare( bobj.id );
				}
			});
			
			txt_count.html( ary_deck.length );
			
			_.each( ary_deck, function( card ){
				var cardItem = $("#tmpl_cardItem" ).tmpl( card );
				cardItem.find( 'div[game]' ).hide();
				cardItem.find( 'div[game=' + game + ']' ).show();
				mc_cardContainer.append( cardItem );
				
				cardItem.find( '#btn_remove' ).linkbutton( {
					onClick:function(){
						var removeId = $(this ).parent().parent().attr( 'id' );
						removeCardFromDeck( removeId );	
						setDeck();
					}
				});
				
				cardItem.find( '#btn_copy' ).linkbutton( {
					onClick:function(){
						var addId = $(this ).parent().parent().attr( 'id' );
						coptyCardFromDeck( addId );
					}
				});
				
				cardItem.click( function(){
					var showId = $( this ).attr( 'id' );
					searchCardFromDeck( showId );
				});
			});
			
			if( oldtop != 0 ){
				mc_cardContainer.parent().scrollTop( oldtop );
			}
			
		}
		
		function removeCardFromDeck( itemId ){
			var removeItem = _.find( ary_deck, function( cardItem ){
				return cardItem.itemId == itemId;
			});
			ary_deck.splice( ary_deck.indexOf( removeItem ), 1 );
		}
		
		function coptyCardFromDeck( itemId ){
			var beCopyItem = _.find( ary_deck, function( cardItem ){
				return cardItem.itemId == itemId;
			});
			
			var copyItem = JSON.parse( JSON.stringify( beCopyItem ) );
			copyItem.itemId = getId();
			
			ary_deck.push( copyItem );
			setDeck();
		}
		
		function searchCardFromDeck( itemId ){
			var searchCard = _.find( ary_deck, function( cardItem ){
				return cardItem.itemId == itemId;
			});
			searchCards( 'id=' + searchCard.id );
		}
		
		function pushToDeck( card ){
			var copyCard = JSON.parse( JSON.stringify( card ) );
			copyCard.itemId = getId();
			ary_deck.push( copyCard );
			setDeck();
		}
		
		function onSearchClick(){
			googleTracking.click( 'onSearchClick' );
			searchCards( $( document.form_value ).serialize() );
		}
		
		function searchCards( searchstr ){
			currentPage = 0;
			pag_bigCard.pagination( 'select', 1 );
			
			ary_cards = searchLib( searchstr ).slice();
			
			createBigCard();
			setPagination( ary_cards.length );
		}
		
		
		
		function searchLib( str ){
			var fns = gameController.getQueryStr( game, str );
			return cardsearch.search( fns, cardlist );
		}
		
		function setPagination( total ){
			pag_bigCard.pagination({ total : total, onSelectPage : function(pageNumber,pageSize) {
				currentPage = pageNumber - 1;
				if( currentPage < 0 ) currentPage = 0;
				createBigCard();
			}});
		}
		
		function onClearClick(){
			googleTracking.click( 'onClearClick' );
			ary_deck = [];
			mc_cardContainer.empty();
			setDeck();
		}
		
		function onSaveClick(){
			googleTracking.click( 'onSaveClick' );
			win_output.window('open' );
			var ary_new = _.map( ary_deck, function( card ){
				switch( game ){
				default:
					return card.id
				case 'sangoWar':
					return sangoWar.formatKey( card.id );
				}
			});
			var outputstr = JSON.stringify( ary_new );
			outputstr = outputstr.substr( 1, outputstr.length - 2 );
			win_output.find( '.easyui-textbox' ).textbox( 'setText', outputstr);
		}
		
		function onLoadClick(){
			googleTracking.click( 'onLoadClick' );
			var str = win_output.find( '.easyui-textbox' ).textbox( 'getText');
			str = '[' + str + ']';
			try{
				var inputobj = JSON.parse( str );
				win_output.window('close' );
				
				var lostCards = [];
				ary_deck = _.map( inputobj, function( incard ){
					var retobj = _.find( cardlist, function( oricard ){
						return oricard.id.indexOf( incard.replace( '.jpg', '' ) ) == 0;
					});
					if( retobj == undefined ){
						lostCards.push( incard );
					}
					return retobj;
				});
				
				ary_deck = _.filter( ary_deck, function( cardItem ){
					return cardItem != undefined;
				});
				
				if( ary_deck.length == 0 ){
					showMessage( '系統中沒有任何您所輸入的卡片哦' );
				}else{
					if( lostCards.length > 0 ){
						showMessage( '系統中找不到這些卡片哦! 代碼: ' + JSON.stringify( lostCards ) );
					}
					
					_.each( ary_deck, function( card ){
						card.itemId = getId();
						card.url = gameController.getCardUrl( game, card );
						if( card.url == undefined ) {
							card.url = 'images/cardback.png';
						}
					});
					setDeck();
				}
			}catch( e ){
				$.messager.alert('提示','格式錯誤哦');
			}
		}
		
		function showMessage( msg ){
			$.messager.show({
				title:'提示',
				msg: msg,
				timeout:5000,
				showType:'slide'
			});
		}
		
		function onResetClick(){
			googleTracking.click( 'onResetClick' );
			$('form').find( 'select' ).val('');
			$('form').find( 'input[type=checkbox]' ).prop('checked', false);
			$('form').find( 'input[type=text]' ).val('');
		}
		
		function onSetDeckClick(){
			googleTracking.click( 'onSetDeckClick' );
			window.open('https://particle-979.appspot.com/manager/index.html#');
		}
		
		function onGotoGameClick(){
			googleTracking.click( 'onGotoGameClick' );
			window.open('https://particle-979.appspot.com/card/index.html#');
		}
		
		module.onResetClick = onResetClick;
		module.onSearchClick = onSearchClick;
		module.onClearClick = onClearClick;
		module.onSaveClick = onSaveClick;
		module.onLoadClick = onLoadClick;
		module.onSetDeckClick = onSetDeckClick;
		module.onGotoGameClick = onGotoGameClick;
		
	})( app.view );
	</script>
</body>
</html>