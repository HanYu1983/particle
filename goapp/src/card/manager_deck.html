<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8"/>
	<title>余氏組牌機</title>
	<!--page information for search engine-->
	<meta name="title" content="余氏組牌機" />
	<meta name="keyword" content="余氏組牌機,卡牌風雲,三國志大戰,集換式卡牌,線上卡牌,虛擬桌面,組牌機" />
	<meta name="description" content="余氏組牌機" />
	<link rel="image_src" href=""/>
	
	<!--share information for fb-->
	<meta property="og:description" content="余氏組牌機" />
	<meta property="og:title" content="余氏組牌機" />
	<meta property="og:url" content="http://particle-979.appspot.com/card/manager_sango.html#"/>
	<meta name="description" content="" />
	
	<link rel="stylesheet" type="text/css" href="../common/js/lib/jquery-easyui-1.4.3/themes/black/easyui.css">
	<link rel="stylesheet" type="text/css" href="../common/js/lib/jquery-easyui-1.4.3/themes/icon.css">
	<link rel="stylesheet" type="text/css" href="../common/css/normalize.css">
		
	<script type="text/javascript" src="../common/js/lib/leo.utils.js"></script>
	<script type="text/javascript" src="../common/js/lib/underscore/underscore-min.js"></script>
	<script type="text/javascript" src="../common/js/lib/jquery-easyui-1.4.3/jquery.min.js"></script>
	<script type="text/javascript" src="../common/js/lib/jquery-easyui-1.4.3/jquery.easyui.min.js"></script>
	<script type="text/javascript" src="../common/js/lib/jquery/jquery.tmpl.min.js"></script>
	<script type="text/javascript" src="../common/js/lib/google/ga.js"></script>
	<script src="../common/js/lib/csv.js"></script>
	<script src="../common/js/lib/purl.js"></script>	
	<script src="../common/js/sangoWar.js"></script>	
	<script src="../common/js/yugioh.js"></script>	
	<script src="../common/js/magic.js"></script>	
	<script src="../common/js/cardsearch.js"></script>	
	<script src='js/api.js'></script>
</head>
<style>
body{
	position:absolute;
	top:0;
	left:0;
	width:100%;
	height:100%;
}
.group{
	position:relative;
	width:100%;
}
.hori{
	display:inline-block;
}

.card_item_root{
	position:relative;
	width:100%;
	height:60px;
	border:1px black solid;
}

.big_card_root{
	position:relative;
	display:inline-block;
	width:260px;
	height:390px;;
	cursor:pointer;
	border:1px black solid;
}

.big_card_root_focus{
	border:1px red solid;
}
</style>

<script id="tmpl_bigCard" type="jquery-x-tmpl">
	<div cid=${id} class="big_card_root">
		<img style="position:absolute; left:0; top:0; width:100%; height:100%;" src="../common/images/card/cardback_0.png"/>
		<img src=${url} style="position:relative; top:0; left:0; width:100%; height:100%;" />
		<img style="position:absolute; left:0; top:0; width:100%; height:100%;" src="images/sampleTxt.png"/>
		<div style="position:absolute; left:0; top:0;  width:100%; height:100%; background-color:black; opacity:.5;"></div>
		<div style="position:absolute; top:0; left:0; padding-left:50px; padding-right:10px; padding-top:10px; ">
			<div>${id}</div>
			<div game="sangoWar">${cname}</div>
			<div game="sangoWar">${ability}</div>
			<div game="sangoWar">${content}</div>
			<br/>
			<div game="sangoWar">${counter}</div>
			
			<div game="yugioh">${name}</div>
			<div game="yugioh">level ${level}</div>
			<div game="yugioh">${type}</div>
			<div game="yugioh">${race}</div>
			<div game="yugioh">${text}</div>
			
			<div game="magic">${type}</div>
			<div game="magic">${text}</div>
		</div>
	</div>
</script>
<script id="tmpl_cardItem" type="jquery-x-tmpl">
	<div id=${itemId} cid=${id} class="card_item_root">
		<div class="hori" style="position:relative; top:0; left:0; height:100%; vertical-align:top;">
			<a id="btn_remove" href="#" class="easyui-linkbutton" style="width:30px; height:100%;" data-options="iconCls:'icon-remove'"></a>
		</div>
		<div class="hori" style="position:relative; top:0; left:0; height:100%; vertical-align:top;">
			<a id="btn_copy" href="#" class="easyui-linkbutton" style="width:30px; height:100%;" data-options="iconCls:'icon-add'"></a>
		</div>
		<div class="hori" style="position:relative; height:100%;">
			<img style="position:relative; left:0; top:0; height:100%;" src="../common/images/card/cardback_0.png"/>
			<img style="position:absolute; left:0; top:0; height:100%;" src=${url}  style="height:100%;" />
		</div>
		<div class="hori" style=" vertical-align:top;">
			<div>${id}</div>
			<div game="sangoWar">${cname}</div>
			<div game="sangoWar">${ctype}</div>
			
			<div game="yugioh">${name}</div>
			<div game="yugioh">level ${level}</div>
			<div game="yugioh">${type}</div>

			<div game="magic">${type}</div>
		</div>
	</div>
</script>
<!--
id: card.find('name').html(),
name: card.find('name').html(),
color: "UB",
manacost: [W, B, R, U, G, 5],
cmc: card.find('cmc').html(),
type: card.find('type').html(),
tablerow: card.find('tablerow').html(),
text: card.find('text').html(),
atk: atk,
def: def
-->
<script id="tmpl_magicForm" type="jquery-x-tmpl">
	<table border="1">
		<tr>
			<td>白</td>
			<td>
				<select name="white_1">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以上
				<select name="white_2">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以下
			</td>
			<td>綠</td>
			<td>
				<select name="green_1">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以上
				<select name="green_2">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>藍</td>
			<td>
				<select name="blue_1">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以上
				<select name="blue_2">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以下
			</td>
			<td>紅</td>
			<td>
				<select name="red_1">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以上
				<select name="red_2">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>黑</td>
			<td>
				<select name="black_1">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以上
				<select name="black_2">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
				</select>
				以下
			</td>
			<td>總cost</td>
			<td>
				<select name="all_1">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以上
				<select name="all_2">
					<option></option>
					<option>0</option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>系列</td>
			<td colspan=3>
				<select name="set">
					<option></option>
					<option value="2ED">2ED</option>
					<option value="3ED">3ED</option>
					<option value="4ED">4ED</option>
					<option value="5DN">5DN</option>
					<option value="5ED">5ED</option>
					<option value="6ED">6ED</option>
					<option value="7ED">7ED</option>
					<option value="8ED">8ED</option>
					<option value="9ED">9ED</option>
					
				</select>
			</td>
		</tr>
		<tr>
			<td>卡片類型</td>
			<td colspan=3>
				<select name="ctype">
					<option></option>
					<option>Land</option>
					<option>Instant</option>
					<option>Sorcery</option>
					<option>Enchantment</option>
					<option>Enchantment — Aura</option>
					<option>Artifact</option>
					<option>Artifact Creature</option>
					<option>Legendary Enchantment</option>
					<option>Legendary Creature</option>
					<option>Legendary Artifact</option>
					<option>Creature</option>
					<option>Creature — Advisor</option><option>Creature — Ally</option><option>Creature — Angel</option><option>Creature — Antelope</option><option>Creature — Ape</option><option>Creature — Archer</option><option>Creature — Archon</option><option>Creature — Artificer</option><option>Creature — Assassin</option><option>Creature — Assembly-Worker</option><option>Creature — Atog</option><option>Creature — Aurochs</option><option>Creature — Avatar</option><option>Creature — Badger</option><option>Creature — Barbarian</option><option>Creature — Basilisk</option><option>Creature — Bat</option><option>Creature — Bear</option><option>Creature — Beast</option><option>Creature — Beeble</option><option>Creature — Berserker</option><option>Creature — Bird</option><option>Creature — Blinkmoth</option><option>Creature — Boar</option><option>Creature — Bringer</option><option>Creature — Brushwagg</option><option>Creature — Camarid</option><option>Creature — Camel</option><option>Creature — Caribou</option><option>Creature — Carrier</option><option>Creature — Cat</option><option>Creature — Centaur</option><option>Creature — Cephalid</option><option>Creature — Chimera</option><option>Creature — Citizen</option><option>Creature — Cleric</option><option>Creature — Cockatrice</option><option>Creature — Construct</option><option>Creature — Coward</option><option>Creature — Crab</option><option>Creature — Crocodile</option><option>Creature — Cyclops</option><option>Creature — Dauthi</option><option>Creature — Demon</option><option>Creature — Deserter</option><option>Creature — Devil</option><option>Creature — Djinn</option><option>Creature — Dragon</option><option>Creature — Drake</option><option>Creature — Dreadnought</option><option>Creature — Drone</option><option>Creature — Druid</option><option>Creature — Dryad</option><option>Creature — Dwarf</option><option>Creature — Efreet</option><option>Creature — Elder</option><option>Creature — Eldrazi</option><option>Creature — Elemental</option><option>Creature — Elephant</option><option>Creature — Elf</option><option>Creature — Elk</option><option>Creature — Eye</option><option>Creature — Faerie</option><option>Creature — Ferret</option><option>Creature — Fish</option><option>Creature — Flagbearer</option><option>Creature — Fox</option><option>Creature — Frog</option><option>Creature — Fungus</option><option>Creature — Gargoyle</option><option>Creature — Germ</option><option>Creature — Giant</option><option>Creature — Gnome</option><option>Creature — Goat</option><option>Creature — Goblin</option><option>Creature — God</option><option>Creature — Golem</option><option>Creature — Gorgon</option><option>Creature — Graveborn</option><option>Creature — Gremlin</option><option>Creature — Griffin</option><option>Creature — Hag</option><option>Creature — Harpy</option><option>Creature — Hellion</option><option>Creature — Hippo</option><option>Creature — Hippogriff</option><option>Creature — Homarid</option><option>Creature — Homunculus</option><option>Creature — Horror</option><option>Creature — Horse</option><option>Creature — Hound</option><option>Creature — Human</option><option>Creature — Hydra</option><option>Creature — Hyena</option><option>Creature — Illusion</option><option>Creature — Imp</option><option>Creature — Incarnation</option><option>Creature — Insect</option><option>Creature — Jellyfish</option><option>Creature — Juggernaut</option><option>Creature — Kavu</option><option>Creature — Kirin</option><option>Creature — Kithkin</option><option>Creature — Knight</option><option>Creature — Kobold</option><option>Creature — Kor</option><option>Creature — Kraken</option><option>Creature — Lamia</option><option>Creature — Lammasu</option><option>Creature — Leech</option><option>Creature — Leviathan</option><option>Creature — Lhurgoyf</option><option>Creature — Licid</option><option>Creature — Lizard</option><option>Creature — Manticore</option><option>Creature — Masticore</option><option>Creature — Mercenary</option><option>Creature — Merfolk</option><option>Creature — Metathran</option><option>Creature — Minion</option><option>Creature — Minotaur</option><option>Creature — Monger</option><option>Creature — Mongoose</option><option>Creature — Monk</option><option>Creature — Moonfolk</option><option>Creature — Mutant</option><option>Creature — Myr</option><option>Creature — Mystic</option><option>Creature — Naga</option><option>Creature — Nautilus</option><option>Creature — Nephilim</option><option>Creature — Nightmare</option><option>Creature — Nightstalker</option><option>Creature — Ninja</option><option>Creature — Noggle</option><option>Creature — Nomad</option><option>Creature — Nymph</option><option>Creature — Octopus</option><option>Creature — Ogre</option><option>Creature — Ooze</option><option>Creature — Orb</option><option>Creature — Orc</option><option>Creature — Orgg</option><option>Creature — Ouphe</option><option>Creature — Ox</option><option>Creature — Oyster</option><option>Creature — Pegasus</option><option>Creature — Pentavite</option><option>Creature — Pest</option><option>Creature — Phelddagrif</option><option>Creature — Phoenix</option><option>Creature — Pincher</option><option>Creature — Pirate</option><option>Creature — Plant</option><option>Creature — Praetor</option><option>Creature — Prism</option><option>Creature — Processor</option><option>Creature — Rabbit</option><option>Creature — Rat</option><option>Creature — Rebel</option><option>Creature — Reflection</option><option>Creature — Rhino</option><option>Creature — Rigger</option><option>Creature — Rogue</option><option>Creature — Sable</option><option>Creature — Salamander</option><option>Creature — Samurai</option><option>Creature — Sand</option><option>Creature — Saproling</option><option>Creature — Satyr</option><option>Creature — Scarecrow</option><option>Creature — Scion</option><option>Creature — Scorpion</option><option>Creature — Scout</option><option>Creature — Serf</option><option>Creature — Serpent</option><option>Creature — Shade</option><option>Creature — Shaman</option><option>Creature — Shapeshifter</option><option>Creature — Sheep</option><option>Creature — Siren</option><option>Creature — Skeleton</option><option>Creature — Slith</option><option>Creature — Sliver</option><option>Creature — Slug</option><option>Creature — Snake</option><option>Creature — Soldier</option><option>Creature — Soltari</option><option>Creature — Spawn</option><option>Creature — Specter</option><option>Creature — Spellshaper</option><option>Creature — Sphinx</option><option>Creature — Spider</option><option>Creature — Spike</option><option>Creature — Spirit</option><option>Creature — Splinter</option><option>Creature — Sponge</option><option>Creature — Squid</option><option>Creature — Squirrel</option><option>Creature — Starfish</option><option>Creature — Surrakar</option><option>Creature — Survivor</option><option>Creature — Tetravite</option><option>Creature — Thalakos</option><option>Creature — Thopter</option><option>Creature — Thrull</option><option>Creature — Treefolk</option><option>Creature — Triskelavite</option><option>Creature — Troll</option><option>Creature — Turtle</option><option>Creature — Unicorn</option><option>Creature — Vampire</option><option>Creature — Vedalken</option><option>Creature — Viashino</option><option>Creature — Volver</option><option>Creature — Wall</option><option>Creature — Warrior</option><option>Creature — Weird</option><option>Creature — Werewolf</option><option>Creature — Whale</option><option>Creature — Wizard</option><option>Creature — Wolf</option><option>Creature — Wolverine</option><option>Creature — Wombat</option><option>Creature — Worm</option><option>Creature — Wraith</option><option>Creature — Wurm</option><option>Creature — Yeti</option><option>Creature — Zombie</option><option>Creature — Zubera</option>
				</select>
			</td>
		</tr>
		<tr>
			<td>攻擊力&防守力</td>
			<td colspan=3>
				攻擊力
				<select name="atk_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以上
				<select name="atk_2">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以下 || 防守力
				<select name="def_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以上
				<select name="def_2">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
		  <td >
			特殊規則<br>
		  </td>
		  <td colspan="3">
			<input type="checkbox" name="Deathtouch">Deathtouch
			<input type="checkbox" name="Defender">Defender
			<input type="checkbox" name="First strike">First strike
			<input type="checkbox" name="Double strike">Double strike
			<input type="checkbox" name="Flash">Flash
			<input type="checkbox" name="Flying">Flying
			<input type="checkbox" name="Haste">Haste
			<input type="checkbox" name="Hexproof">Hexproof
			<input type="checkbox" name="Protection from white">Protection from white
			<input type="checkbox" name="Protection from blue">Protection from blue
			<input type="checkbox" name="Protection from black">Protection from black
			<input type="checkbox" name="Protection from red">Protection from red
			<input type="checkbox" name="Protection from green">Protection from green
			<input type="checkbox" name="Reach">Reach
			<input type="checkbox" name="Trample">Trample
			<input type="checkbox" name="Vigilance">Vigilance
		  </td>
		</tr>
		<tr>
		  <td >
			卡片名稱檢索<br>
		  </td>
		  <td colspan="3">
			<input type="text" name="card_name" size=32>
			<br>
		  </td>
		</tr>
		<tr>
		  <td >
			卡片規則檢索<br>
		  </td>
		  <td colspan="3">
			<input type="text" name="rule" size=32>
			<br>
		  </td>
		</tr>
	</table>
</script>
			<!--
			alias: coldata[11],
			setcode: coldata[12]
			-->
<script id="tmpl_yugiohForm" type="jquery-x-tmpl">
	<table border=1>	
		<tr>
			<td>星級</td>
			<td>
				<select name="level_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
					<option>11</option>
					<option>12</option>
				</select>
				以上
				<select name="level_2">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
					<option>11</option>
					<option>12</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>屬性</td>
			<td>
				<select name="attr">
					<option></option>
					<option>Earth</option>
					<option>Water</option>
					<option>Fire</option>
					<option>Wind</option>
					<option>Light</option>
					<option>Dark</option>
					<option>Divine</option>
				</select>
			</td>
		</tr>
		<tr>
			<td>種族</td>
			<td>
				<select name="race">
					<option></option>
					<option>Warrior</option>
					<option>Spellcaster</option>
					<option>Fairy</option>
					<option>Fiend</option>
					<option>Zombie</option>
					<option>Machine</option>
					<option>Aqua</option>
					<option>Pyro</option>
					<option>Rock</option>
					<option>Winged Beast</option>
					<option>Plant</option>
					<option>Insect</option>
					<option>Thunder</option>
					<option>Dragon</option>
					<option>Beast</option>
					<option>Beast-Warrior</option>
					<option>Dinosaur</option>
					<option>Fish</option>
					<option>Sea Serpent</option>
					<option>Reptile</option>
					<option>Psychic</option>
					<option>Divine-Beast</option>
					<option>Creator God</option>
					<option>Wyrm</option>
				</select>
			</td>
		</tr>
		
		<tr>
			<td>卡片類型</td>
			<td>
				<select name="ctype">
					<option></option>
					<option>Monster</option>
					<option>Spell</option>
					<option>Trap</option>
				</select>
				<select name="ctype2">
					<option></option>
					<option>Normal</option>
					<option>Effect</option>
					<option>Fusion</option>
					<option>Ritual</option>
					<option>Trap Monsters</option>
					<option>Spirit</option>
					<option>Union</option>
					<option>Gemini</option>
					<option>Tuner</option>
					<option>Synchro</option>
					<option>Token</option>
					<option>Quick-Play</option>
					<option>Continuous</option>
					<option>Equip</option>
					<option>Field</option>
					<option>Counter</option>
					<option>Flip</option>
					<option>Toon</option>
					<option>Xyz</option>
					<option>Pendulum</option>
				</select>
			</td>
		</tr>
		<tr>
			<td>攻擊力</td>
			<td>
				<select name="atk_1">
					<option></option>
					<option>500</option>
					<option>1000</option>
					<option>1500</option>
					<option>2000</option>
					<option>2500</option>
					<option>3000</option>
					<option>3500</option>
					<option>4000</option>
					<option>4500</option>
					<option>5000</option>
				</select>
				以上
				<select name="atk_2">
					<option></option>
					<option>500</option>
					<option>1000</option>
					<option>1500</option>
					<option>2000</option>
					<option>2500</option>
					<option>3000</option>
					<option>3500</option>
					<option>4000</option>
					<option>4500</option>
					<option>5000</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>防守力</td>
			<td>
				<select name="def_1">
					<option></option>
					<option>500</option>
					<option>1000</option>
					<option>1500</option>
					<option>2000</option>
					<option>2500</option>
					<option>3000</option>
					<option>3500</option>
					<option>4000</option>
					<option>4500</option>
					<option>5000</option>
				</select>
				以上
				<select name="def_2">
					<option></option>
					<option>500</option>
					<option>1000</option>
					<option>1500</option>
					<option>2000</option>
					<option>2500</option>
					<option>3000</option>
					<option>3500</option>
					<option>4000</option>
					<option>4500</option>
					<option>5000</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>左擺蕩</td>
			<td>
				<select name="lscale_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以上
				<select name="lscale_2">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
			<td>右擺蕩</td>
			<td>
				<select name="rscale_1">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以上
				<select name="rscale_2">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
					<option>7</option>
					<option>8</option>
					<option>9</option>
					<option>10</option>
				</select>
				以下
			</td>
		</tr>
		<tr>
		  <td >
			卡片名稱檢索<br>
		  </td>
		  <td colspan="3">
			<input type="text" name="card_name" size=32>
			<br>
		  </td>
		</tr>
		<tr>
		  <td >
			卡片規則檢索<br>
		  </td>
		  <td colspan="3">
			<input type="text" name="rule" size=32>
			<br>
		  </td>
		</tr>
		 <tr>
		  <td >
			id檢索<br>
		  </td>
		  <td colspan="3">
			  <input id="txt_id" type="text" name="id" size=16>
		  </td>
		</tr>
	</table>
</script>
<script id="tmpl_sangoWarForm" type="jquery-x-tmpl">
	<table cellpadding=2 cellspacing=0 border=1>	
		<tr>
		  <td >
			勢力<br>
		  </td>
		  <td colspan="3">
			  <select name="ntype">
				  <option></option>
				  <option>蜀</option>
				  <option>魏</option>
				  <option>呉</option>
				  <option>漢</option>
				  <option>群</option>
				  <option>他</option>
			  </select>
		  </td>
		</tr>
		<tr>
		  <td >
			卡片種類<br>
		  </td>
		  <td colspan="3">
			  <select name="ctype">
				  <option></option>
				  <option>武将</option>
				  <option>武将/兵隊</option>
				  <option>計略</option>
				  <option>キャンペーン</option>
			  </select>
			</td>
		</tr>
		<tr>
		  <td  width="25%">
			指定cost<br>
		  </td>
		  <td width="25%">
			<select name="cost_1">
			  <option></option>
			  <option>1</option>
			  <option>2</option>
			  <option>3</option>
			  <option>4</option>
				<option>5</option>
			</select>
			以上
			<select name="cost_2">
			  <option></option>
			  <option>1</option>
			  <option>2</option>
			  <option>3</option>
			  <option>4</option>
				<option>5</option>
			</select>
			以下
			<br>
		  </td>
		  <td  width="25%">
			武力<br>
		  </td>
		  <td width="25%">
			<select name="power_1">
			  <option value=""></option>
			  <option value="500">500</option>
			  <option value="1000">1000</option>
			  <option value="1500">1500</option>
			  <option value="2000">2000</option>
			  <option value="2500">2500</option>
			  <option value="3000">3000</option>
			  <option value="3500">3500</option>
			  <option value="4000">4000</option>
			  <option value="4500">4500</option>
			</select>
			以上
			<select name="power_2">
			  <option value=""></option>
			  <option value="500">500</option>
			  <option value="1000">1000</option>
			  <option value="1500">1500</option>
			  <option value="2000">2000</option>
			  <option value="2500">2500</option>
			  <option value="3000">3000</option>
			  <option value="3500">3500</option>
			  <option value="4000">4000</option>
			  <option value="4500">4500</option>
			</select>
			以下   
			<br>
		  </td>
		</tr>
		<tr>
		  <td>
			合計cost<br>
		  </td>
		  <td>
			<select name="costAll_1">
			  <option value=""></option>
			  <option>1</option>
			  <option>2</option>
			  <option>3</option>
			  <option>4</option>
				<option>5</option>
				<option>6</option>
				<option>7</option>
				<option>8</option>
				<option>9</option>
				<option>10</option>
			</select>
			以上
			<select name="costAll_2">
			  <option value=""></option>
			  <option>1</option>
			  <option>2</option>
			  <option>3</option>
			  <option>4</option>
				<option>5</option>
				<option>6</option>
				<option>7</option>
				<option>8</option>
				<option>9</option>
				<option>10</option>
			</select>
			以下
			<br>
		  </td>
		  <td >
			攻城<br>
		  </td>
		  <td>
			<select name="acity">
			  <option value=""></option>
			  <option>1</option>
			  <option>2</option>
			</select>
		  </td>
		</tr>
		<tr>
		  <td >
			兵種<br>
		  </td>
		  <td colspan="3">
			<select name="atype">
				<option></option>
				<option>槍兵</option>
				<option>騎兵</option>
				<option>弓兵</option>
				<option>歩兵</option>
				<option>象兵</option>
			</select>
		  </td>
		</tr>
		<tr>
		  <td >
			特徵<br>
		  </td>
		  <td colspan="3">
			  <select name="symbol">
				  <option></option>
				  <option>計略/戦闘</option>
				  <option>計略/メイン</option>
				  <option>女性</option>
				  <option>南蛮・女性</option>
				  <option>魏五将</option>
				  <option>五虎将</option>
				  <option>軍師</option>
				  <option>黄巾</option>
				  <option>兵隊</option>
				  <option>旗本四天王</option>
				  <option>君主</option>
				  <option>賢女</option>
				  <option>西園八校尉</option>
				  <option>十常侍</option>
			  </select>
		  </td>
		</tr>
		<tr>
		  <td >
			特殊規則<br>
		  </td>
		  <td colspan="3">
			<input type="checkbox" name="戦象">戦象
			<input type="checkbox" name="走射">走射
			<input type="checkbox" name="決起">決起
			<input type="checkbox" name="奇襲">奇襲
			<input type="checkbox" name="長槍">長槍
			<input type="checkbox" name="外交">外交
			<input type="checkbox" name="伏兵">伏兵
			<input type="checkbox" name="乱舞">乱舞
			<input type="checkbox" name="憂国">憂国
			<input type="checkbox" name="支援">支援
			<input type="checkbox" name="募兵">募兵
			<input type="checkbox" name="貫通">貫通
			<input type="checkbox" name="援軍">援軍
			<input type="checkbox" name="回避">回避
			<input type="checkbox" name="防柵">防柵
			<input type="checkbox" name="補佐">補佐
			<input type="checkbox" name="連弩">連弩
			<input type="checkbox" name="舞闘">舞闘
			<input type="checkbox" name="強進">強進
			<input type="checkbox" name="先駆">先駆
			<input type="checkbox" name="覚醒">覚醒
			<input type="checkbox" name="国防">国防
			<input type="checkbox" name="突撃">突撃
			<input type="checkbox" name="威圧">威圧
			<input type="checkbox" name="同盟">同盟
		  </td>
		</tr>
		<tr>
		  <td >
			卡片名稱檢索<br>
		  </td>
		  <td colspan="3">
			<input type="text" name="card_name" size=32>
			<br>
		  </td>
		</tr>
		<tr>
		  <td >
			卡片規則檢索<br>
		  </td>
		  <td colspan="3">
			<input type="text" name="rule" size=32>
			<br>
		  </td>
		</tr>
		 <tr>
		  <td >
			id檢索<br>
		  </td>
		  <td colspan="3">
			  <input id="txt_id" type="text" name="id" size=16>
		  </td>
		</tr>
	  </table>
</script>
<body>
	<div id="cc" class="easyui-layout" style="width:100%;height:100%;">
		<div data-options="region:'north',title:'條件',split:true" style="height:330px;">
			<div class="group" style="text-align:center; margin-top:10px;">
				<div class="group">
					<form id="form_container" name="form_value" class="hori">
						<!-- by script -->
					</form>
				</div>
				<div class="group">
					<div class="hori">
						<a id="btn" href="#" class="easyui-linkbutton" style="width:200px; height:40px;" onclick="app.view.onResetClick()" data-options="iconCls:'icon-edit'">重設</a>
					</div>
					<div class="hori">
						<a id="btn_search" href="#" class="easyui-linkbutton" style="width:200px; height:40px;" onclick="app.view.onSearchClick()" data-options="iconCls:'icon-search',disabled:true">搜尋</a>
					</div>
				</div>
				<div style="position:absolute; right:5px; top:0px; ">
					<a id="btn_about" href="#" title="其它遊戲的組牌機，目前有三國志大戰、遊戲王、魔法風雲會" class="easyui-linkbutton easyui-tooltip" onclick="$('#dia_others').panel( 'open' )" data-options="iconCls:'icon-redo'">其它遊戲</a>
					<a id="btn_about" href="#" title="關於上善若水" class="easyui-linkbutton easyui-tooltip" onclick="$('#dia_about').panel( 'open' )" data-options="iconCls:'icon-help'"></a>
				</div>
			</div>
		</div>
		<div data-options="region:'center',title:'結果'">
			<div id="pag_bigCard" class="easyui-pagination" data-options="pageSize:20,layout:['first','links','last']"></div>
			<div id="mc_bigCardContainer" >
				
			</div>
		</div>
		<div data-options="region:'east',title:'組牌'" style="width:350px; overflow-x:hidden;">
			<div class="group" style="text-align:center; margin-top:10px;">
				<div class="hori">
					<span id="txt_count" style="color:yellow">0</span>張
				</div>
				<div class="hori">
					<div class="hori">
						<a id="btn" href="#" class="easyui-linkbutton" style="width:100px; height:40px;" onclick="app.view.onClearClick()" data-options="iconCls:'icon-remove'">清空</a>
					</div>
					<div class="hori">
						<a id="btn_output" href="#" class="easyui-linkbutton" style="width:100px; height:40px;" onclick="app.view.onSaveClick()" data-options="iconCls:'icon-save',disabled:true">匯入/匯出</a>
					</div>
				</div>
			</div>
			<div id="mc_cardContainer" class="group" style="margin-top:10px;">
				
			</div>
		</div>
	</div>
	<div id="win_output" class="easyui-window" title="匯入/匯出" data-options="minimizable:false,maximizable:false,collapsible:false,closed:true,modal:true" style="width:500px;height:300px" >
		<div class="group" style="text-align:center;">
			<input class="easyui-textbox" data-options="multiline:true" style="width:100%; height:200px">
			<div class="hori" style="margin-top:10px;">
				<a id="btn" href="#" class="easyui-linkbutton" style="width:80px; height:40px;" onclick="app.view.onLoadClick()" data-options="iconCls:'icon-save'">匯入</a>
				<a id="btn" href="#" class="easyui-linkbutton" style="width:120px; height:40px;" onclick="window.open('https://particle-979.appspot.com/manager/index.html#');" data-options="iconCls:'icon-back'">去輸入牌組</a>
				<a id="btn" href="#" class="easyui-linkbutton" style="width:140px; height:40px;" onclick="window.open('https://particle-979.appspot.com/card/index.html#');" data-options="iconCls:'icon-redo'">線上打牌去</a>
			</div>
		</div>
	</div>
	<div id="dia_about" class="easyui-dialog" title="卡牌風雲" data-options="iconCls:'icon-help',closed:true" style="padding:10px">
		<div class="group" style="position:relative; width:100%; text-align:center;">
			<div class="hori" >
				上善若水APP
				<br/>
				<img src="../common/images/logo.jpg" width="100" height="100">
				<br/>
				<a style="color:yellow" href="//www.facebook.com/pages/上善若水/1653920964852269" target="_blank">上善若水粉絲頁</a>
				<br/><br/>
				<a style="color:yellow" href="//particle-979.appspot.com/manager/index.html#" target="_blank">上善若水官網&牌組管理器</a>
				<br/><br/>
			</div>
		</div>
	</div>
	<div id="dia_others" class="easyui-dialog" title="組牌機列表" data-options="closed:true" style="padding:10px">
		<div class="group" style="position:relative; width:100%; text-align:center;">
			<div class="hori" >
				<a id="btn_about" href="#" class="easyui-linkbutton" onclick="window.open('manager_deck.html?game=sangoWar')" data-options="iconCls:'icon-redo'">三國志大戰</a>
				<a id="btn_about" href="#" class="easyui-linkbutton" onclick="window.open('manager_deck.html?game=yugioh')" data-options="iconCls:'icon-redo'">遊戲王</a>
				<a id="btn_about" href="#" class="easyui-linkbutton" onclick="window.open('manager_deck.html?game=magic')" data-options="iconCls:'icon-redo'">魔法風雲會</a>
			</div>
		</div>
	</div>
	<script src="js/manager_deck_gameController.js"></script>
	<script>
	googleTracking.init( 'UA-55273266-3' );
	
	var game = (function( hashobj ){
		if( hashobj.game == undefined ) return 'sangoWar';
		switch( hashobj.game ){
			case 'sangoWar':
			case 'yugioh':
			case 'magic':
				return hashobj.game;
			default:
				return 'sangoWar';
		}
	})( leo.utils.getHash() );
	
	var cardlist;
	var itemId = 0;
	var form_container = $('#form_container' );
	var tmpl_form = $('#tmpl_' + game + 'Form' );
	
	form_container.append( tmpl_form.tmpl() );
	gameController.loadCardData( game, onLoadGameCallback );
	
	function onLoadGameCallback( err, _cardlist ){
		cardlist = _cardlist;
		$("#btn_search").linkbutton( 'enable' );
		$("#btn_output").linkbutton( 'enable' );
	}
	
	function getId(){
		return itemId++;
	}
	
	function handleResponse( cb ) {
		return function ( err, ret ) {
			if ( err != null ) {
				alert( '錯誤:' + err );
			}else {
				cb( ret );
			}
		}
	}
	
	var app = app || {};
	app.view = app.view || {};
	
	(function( module ){
		var mc_bigCardContainer = $('#mc_bigCardContainer' );
		var win_output = $('#win_output' );
		var mc_cardContainer = $('#mc_cardContainer' );
		var txt_count = $('#txt_count' );
		var pag_bigCard = $('#pag_bigCard' );
		var currentPage = 0;
		var ary_cards;
		var ary_deck = [];
		
		function createBigCard(){
			if( ary_cards == undefined ) return; 
			mc_bigCardContainer.empty();
			
			var sid = currentPage * 20;
			var eid = currentPage * 20 + 20;
			
			if( eid > ary_cards.length ){
				eid = ary_cards.length;
			}
			
			var showCards = ary_cards.slice( sid, eid );
			_.each( showCards, function( card ){
				card.url = gameController.getCardUrl( game, card );
				if( card.url == undefined ) {
					card.url = 'images/cardback.png';
				}
				
				var div = $("#tmpl_bigCard").tmpl( card );
				div.find( 'div[game]' ).hide();
				div.find( 'div[game=' + game + ']' ).show();
				div.attr( 'data', JSON.stringify( card ));
				div.click( function(){
					var thisDom = $(this);
					outFocusAll();
					thisDom.addClass( 'big_card_root_focus' );
					pushToDeck( JSON.parse( thisDom.attr( 'data' ) ));
				});
				mc_bigCardContainer.append( div );
			});
			
			function outFocusAll(){
				mc_bigCardContainer.find( 'div' ).removeClass( 'big_card_root_focus' );
			}
		}
		
		function setDeck(){
			
			var oldtop = mc_cardContainer.parent().scrollTop();
			mc_cardContainer.empty();
			
			ary_deck.sort( function( aobj, bobj ){
				switch( game ){
					case 'sangoWar':
						return aobj.cname.localeCompare( bobj.cname );
					default:
						return aobj.id.localeCompare( bobj.id );
				}
			});
			
			txt_count.html( ary_deck.length );
			
			_.each( ary_deck, function( card ){
				var cardItem = $("#tmpl_cardItem" ).tmpl( card );
				cardItem.find( 'div[game]' ).hide();
				cardItem.find( 'div[game=' + game + ']' ).show();
				mc_cardContainer.append( cardItem );
				
				cardItem.find( '#btn_remove' ).linkbutton( {
					onClick:function(){
						var removeId = $(this ).parent().parent().attr( 'id' );
						removeCardFromDeck( removeId );	
						setDeck();
					}
				});
				
				cardItem.find( '#btn_copy' ).linkbutton( {
					onClick:function(){
						var addId = $(this ).parent().parent().attr( 'id' );
						coptyCardFromDeck( addId );
					}
				});
				
				cardItem.click( function(){
					var showId = $( this ).attr( 'id' );
					searchCardFromDeck( showId );
				});
			});
			
			if( oldtop != 0 ){
				mc_cardContainer.parent().scrollTop( oldtop );
			}
			
		}
		
		function removeCardFromDeck( itemId ){
			var removeItem = _.find( ary_deck, function( cardItem ){
				return cardItem.itemId == itemId;
			});
			ary_deck.splice( ary_deck.indexOf( removeItem ), 1 );
		}
		
		function coptyCardFromDeck( itemId ){
			var beCopyItem = _.find( ary_deck, function( cardItem ){
				return cardItem.itemId == itemId;
			});
			
			var copyItem = JSON.parse( JSON.stringify( beCopyItem ) );
			copyItem.itemId = getId();
			
			ary_deck.push( copyItem );
			setDeck();
		}
		
		function searchCardFromDeck( itemId ){
			var searchCard = _.find( ary_deck, function( cardItem ){
				return cardItem.itemId == itemId;
			});
			searchCards( 'id=' + searchCard.id );
		}
		
		function pushToDeck( card ){
			var copyCard = JSON.parse( JSON.stringify( card ) );
			copyCard.itemId = getId();
			ary_deck.push( copyCard );
			setDeck();
		}
		
		function onSearchClick(){
			googleTracking.click( 'onSearchClick' );
			searchCards( $( document.form_value ).serialize() );
		}
		
		function searchCards( searchstr ){
			currentPage = 0;
			pag_bigCard.pagination( 'select', 1 );
			
			ary_cards = searchLib( searchstr ).slice();
			
			createBigCard();
			setPagination( ary_cards.length );
		}
		
		
		
		function searchLib( str ){
			var fns = gameController.getQueryStr( game, str );
			return cardsearch.search( fns, cardlist );
		}
		
		function setPagination( total ){
			pag_bigCard.pagination({ total : total, onSelectPage : function(pageNumber,pageSize) {
				currentPage = pageNumber - 1;
				if( currentPage < 0 ) currentPage = 0;
				createBigCard();
			}});
		}
		
		function onClearClick(){
			googleTracking.click( 'onClearClick' );
			ary_deck = [];
			mc_cardContainer.empty();
			setDeck();
		}
		
		function onSaveClick(){
			googleTracking.click( 'onSaveClick' );
			win_output.window('open' );
			var ary_new = _.map( ary_deck, function( card ){
				switch( game ){
				default:
					return card.id
				case 'sangoWar':
					return sangoWar.formatKey( card.id );
				}
			});
			var outputstr = JSON.stringify( ary_new );
			outputstr = outputstr.substr( 1, outputstr.length - 2 );
			win_output.find( '.easyui-textbox' ).textbox( 'setText', outputstr);
		}
		
		function onLoadClick(){
			googleTracking.click( 'onLoadClick' );
			var str = win_output.find( '.easyui-textbox' ).textbox( 'getText');
			str = '[' + str + ']';
			try{
				var inputobj = JSON.parse( str );
				win_output.window('close' );
				
				var lostCards = [];
				ary_deck = _.map( inputobj, function( incard ){
					var retobj = _.find( cardlist, function( oricard ){
						return oricard.id.indexOf( incard.replace( '.jpg', '' ) ) == 0;
					});
					if( retobj == undefined ){
						lostCards.push( incard );
					}
					return retobj;
				});
				
				ary_deck = _.filter( ary_deck, function( cardItem ){
					return cardItem != undefined;
				});
				
				if( ary_deck.length == 0 ){
					showMessage( '系統中沒有任何您所輸入的卡片哦' );
				}else{
					if( lostCards.length > 0 ){
						showMessage( '系統中找不到這些卡片哦! 代碼: ' + JSON.stringify( lostCards ) );
					}
					
					_.each( ary_deck, function( card ){
						card.itemId = getId();
						card.url = gameController.getCardUrl( game, card );
						if( card.url == undefined ) {
							card.url = 'images/cardback.png';
						}
					});
					setDeck();
				}
			}catch( e ){
				$.messager.alert('提示','格式錯誤哦');
			}
		}
		
		function showMessage( msg ){
			$.messager.show({
				title:'提示',
				msg: msg,
				timeout:5000,
				showType:'slide'
			});
		}
		
		function onResetClick(){
			googleTracking.click( 'onResetClick' );
			$('form').find( 'select' ).val('');
			$('form').find( 'input[type=checkbox]' ).prop('checked', false);
			$('form').find( 'input[type=text]' ).val('');
		}
		
		
		module.onResetClick = onResetClick;
		module.onSearchClick = onSearchClick;
		module.onClearClick = onClearClick;
		module.onSaveClick = onSaveClick;
		module.onLoadClick = onLoadClick;
	})( app.view );
	</script>
</body>
</html>