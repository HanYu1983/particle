<html>

<head>
	<meta charset="utf-8" />
	<link rel="stylesheet" type="text/css" href="../common/js/lib/jquery-easyui-1.4.3/themes/black/easyui.css">
	<link rel="stylesheet" type="text/css" href="../common/js/lib/jquery-easyui-1.4.3/themes/icon.css">
	<link rel="stylesheet" type="text/css" href="../common/css/normalize.css">
	<link rel="stylesheet" type="text/css" href="../common/css/vic.css">

	<script type="text/javascript" src="../common/js/lib/rectSelect/rectSelect.js"></script>
	<link rel="stylesheet" type="text/css" href="../common/js/lib/rectSelect/rectSelect.css">


	<script type="text/javascript" src="../common/js/lib/underscore/underscore-min.js"></script>
	<script type="text/javascript" src="../common/js/lib/jquery-easyui-1.4.3/jquery.min.js"></script>
	<script type="text/javascript" src="../common/js/lib/jquery-easyui-1.4.3/jquery.easyui.min.js"></script>
	<script type="text/javascript" src="../common/js/lib/jquery/jquery.cookie.js"></script>
	<script type="text/javascript" src="../common/js/lib/jquery/jquery.tmpl.min.js"></script>
	<script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/node-uuid/1.4.8/uuid.min.js"></script>
	<script src="js/api.js"></script>
	<script src="js/ooxx.js"></script>
	<script src="js/controller.js"></script>

	<!-- firebase -->
	<script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>
	<script type="text/javascript" src="../common/js/lib/leo.utils.js"></script>
	<script src="../common/js/admin.js"></script>
	<script>admin.init()</script>
</head>
<style>
	body {
		background-color: #333333;
	}
</style>
<script id="tmpl_ooxxContent" type="jquery-x-tmpl">
	<div class="abs pivot" style="left:50%; top:50%;">
		<img id="table" class="rel" style="left:-256px; top:-256px" src="imgs\ooxx\table.png">
	</div>
	<div class="oo abs pivot lock" >
		<img class="rel" style="left:-256px; top:-256px" src="imgs\ooxx\o.png">
	</div>
	<div class="oo abs pivot lock" >
		<img class="rel" style="left:-256px; top:-256px" src="imgs\ooxx\o.png">
	</div>
	<div class="oo abs pivot lock" >
		<img class="rel" style="left:-256px; top:-256px" src="imgs\ooxx\o.png">
	</div>
	<div class="oo abs pivot lock" >
		<img class="rel" style="left:-256px; top:-256px" src="imgs\ooxx\o.png">
	</div>
	<div class="oo abs pivot lock" >
		<img class="rel" style="left:-256px; top:-256px" src="imgs\ooxx\o.png">
	</div>
	<div class="xx abs pivot lock" >
		<img class="rel" style="left:-256px; top:-256px" src="imgs\ooxx\x.png">
	</div>
	<div class="xx abs pivot lock" >
		<img class="rel" style="left:-256px; top:-256px" src="imgs\ooxx\x.png">
	</div>
	<div class="xx abs pivot lock" >
		<img class="rel" style="left:-256px; top:-256px" src="imgs\ooxx\x.png">
	</div>
	<div class="xx abs pivot lock" >
		<img class="rel" style="left:-256px; top:-256px" src="imgs\ooxx\x.png">
	</div>
	<div id="selection" class="abs pivot lock" >
		<img class="rel" style="left:-256px; top:-256px" src="imgs\ooxx\selection.png">
	</div>
</script>
<script id="tmpl_singleIconData" type="jquery-x-tmpl">
	<div class="group singleIconData">
		<div class="hori">
			<a buttonid=${buttonId} href="#" class="easyui-linkbutton" style="width:60px;  " data-options="iconCls:'icon-add', disabled:false">生成</a>
		</div>
		<div class="hori">
			<input value=${content} class="easyui-textbox" style="width:130px;" />
		</div>
		<div class="hori">
			<img class="img_token" style="position:relative; top:7px; left:0; height:20px;" src=${tokenPath} />
		</div>
	</div>
</script>
<style>
	.gameView {
		width: 100%;
		height: 100%;
		transition: .3s ease-in-out;
		overflow: hidden;
	}

	.scaleBig {
		transform: scale(1);
	}

	.scaleSmall {
		transform: scale(.5);
	}

	.inTable{
		background-color: darkgreen;
	}

	.myTurnTable{
		background-color: darkred;
	}

	.notInTable{
		background-color: darkslategray;
	}
</style>

<body>
	<div class="easyui-panel group center left top" style="padding:5px;">
		<select id="combo_type" class="easyui-combobox" name="state" label="State:" labelPosition="top" style="">
			<option value="ooxx">井字遊戲</option>
			<option value="a">五子棋</option>
			<option value="b">中國象棋</option>
		</select>
		<a id="btn_createRoom" class="easyui-linkbutton" data-options="disabled:false">創房</a>
		<a id="btn_refreshRoom" class="easyui-linkbutton" data-options="disabled:false">隨機房</a>
	</div>
	<div class="group full">
		<div class="rel full left top">
			<div gameContent="0" style="transform-origin: left top;"
				class="rel left top gameView notInTable outline_1">

			</div>
			<div gameContent="1" style="transform-origin: right top;"
				class="abs left top gameView notInTable outline_1">

			</div>
			<div gameContent="2" style="transform-origin: left bottom;"
				class="abs left top gameView notInTable outline_1">

			</div>
			<div gameContent="3" style="transform-origin: right bottom;"
				class="abs left top gameView notInTable outline_1">

			</div>
			<div id="bigUIContainer" class="abs" style="padding:5px; left:0; top:0;">
				<a class="easyui-linkbutton">對奕</a>
				<a class="easyui-linkbutton">觀戰</a>
				<a id="btn_scaleSmall" class="easyui-linkbutton">縮小</a>
			</div>
		</div>
		<div tableSamllUiID="0" class="abs" style="left:0; top:0;">
			<div class="rel" style="padding:5px; left:0; top:0;">
				<a class="easyui-linkbutton">對奕</a>
				<a class="easyui-linkbutton">觀戰</a>
				<a class="easyui-linkbutton">退房</a>
				<a class="easyui-linkbutton">放大</a>
			</div>
		</div>
		<div tableSamllUiID="1" class="abs" style="left:50%; top:0;">
			<div class="rel" style="padding:5px; left:0; top:0;">
				<a class="easyui-linkbutton">對奕</a>
				<a class="easyui-linkbutton">觀戰</a>
				<a class="easyui-linkbutton">退房</a>
				<a class="easyui-linkbutton">放大</a>
			</div>
		</div>
		<div tableSamllUiID="2" class="abs" style="left:0; top:50%;">
			<div class="rel" style="padding:5px; left:0; top:0;">
				<a class="easyui-linkbutton">對奕</a>
				<a class="easyui-linkbutton">觀戰</a>
				<a class="easyui-linkbutton">退房</a>
				<a class="easyui-linkbutton">放大</a>
			</div>
		</div>
		<div tableSamllUiID="3" class="abs" style="left:50%; top:50%;">
			<div class="rel" style="padding:5px; left:0; top:0;">
				<a class="easyui-linkbutton">對奕</a>
				<a class="easyui-linkbutton">觀戰</a>
				<a class="easyui-linkbutton">退房</a>
				<a class="easyui-linkbutton">放大</a>
			</div>
		</div>
	</div>

</body>
<script>

	function log(title, msg) {
		console.log("====[" + title + "]====");
		console.log(msg);
		console.log("=======================");
	}

	

	function delayCall(cb, time){
		var tid = setTimeout(() => {
			cb();
			clearTimeout(tid);
		}, time);
	}

	function host() {
		controller.onBtnCreateGameClick();

		delayCall(()=>{
			controller.putOOXXToTargetTable(0, 2, 1);
		}, 20000)
	}

	function guest() {
		delayCall(()=>{
			controller.onBtnRefreshGameClick();
			

			delayCall(()=>{
				controller.onBtnJoinClick({currentTarget:$("[tableSamllUiID='0']").find("a").eq(0)[0]});
					
				delayCall(()=>{
					controller.putOOXXToTargetTable(0, 1, 1);

					delayCall(()=>{
						controller.putOOXXToTargetTable(0, 0, 1);
					}, 10000);
				}, 5000);
			}, 5000)
		}, 5000);
	}

	debug = false;
	ai = true;
	$(document).ready(function () {
		if(debug){
			var id = location.hash.replace("#", "");
			if(id=='') id = api.getUUID();

			if( ai ){
				controller.init(id, id == "vic" ? host : guest);
			}else{
				controller.init(id);
			}
			
		}else{
			var id = api.getMyId();
			controller.init(id);
		}
	})
</script>

</html>