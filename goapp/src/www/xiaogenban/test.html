<meta charset="utf-8" />
<script src="https://code.jquery.com/jquery-3.4.0.min.js"
	integrity="sha256-BJeo0qm959uMBGb65z40ejJYGSgR7REI4+CW1fNKwOg=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/async/2.6.2/async.min.js"></script>
<script src="https://unpkg.com/rxjs/bundles/rxjs.umd.min.js"></script>
<script src="js/api.js"></script>
<script>

	console.log(new Date(api.formateTicks(636563062106140000)))
	api.earnsDetail((err, data) => {
		if (err) {
			return console.log(err)
		}
		var boothStates = data.boothStates;
		var boothStatesOb = rxjs.from(boothStates).pipe(
			rxjs.operators.distinct((d) => `${d.date}-${d.booth}-${d.progress}`),
			rxjs.operators.toArray()
		)
		boothStatesOb.subscribe(datas => {
			console.log(datas)
			console.log(datas.length)
			var left = datas[0]
			for (var i = 1; i < datas.length; ++i) {
				var right = datas[i];
				if (left.booth == right.booth) {
					if (left.date > right.date) {
						console.log("error!!")
						console.log(left, new Date(api.formateTicks(left.date)))
						console.log(right, new Date(api.formateTicks(right.date)))
						left = right;
						continue
					}
				}
				left = right;
			}
		})
		console.log("ok")

		//var earns = data.earns;
		//var ret = api.groupEarns(boothStates, earns);
		//console.log(ret)

	})

</script>